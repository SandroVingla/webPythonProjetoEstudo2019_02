{% extends "modelo.html" %}

{% block title %}Pedido{% endblock %}

{% block content %}
<h1>Pedido</h1>
{% if pagina == 'editar' %}
<form method="POST" action="{{url_for('pedido.adicionarPedidoProduto', id = pedido.id)}}">
    {% else %}
    <form method="POST" action="{{url_for('pedido.formPedido')}}">
        {% endif %}


    
    <div class="row">
        <div class="col col-6">
            <div class="form-group">
                <label for="observacoes">Cliente</label>
            
                <select name="id_cliente" class="form-control">
                    <option value="">Cliente</option>
                    {% for cliente in clientes %}

                    {% if pagina == 'editar' %}

                    <option {{ 'selected' if pedido.clientes_id|string == cliente[0]|string else '' }} value="{{cliente[0]}}">{{cliente[1]}}</option>
                    {% else %}
                    <option  value="{{cliente[0]}}">{{cliente[1]}}</option>

                    {% endif %}
                    {% endfor %}
                </select>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col col-6">
            <div class="form-group">
                <label for="observacoes">Observações</label>
                {% if pagina == 'editar' %}
                <textarea class="form-control" name="observacoes" id="observacoes" rows="2" value="">{{pedido.observacao}}</textarea>
                {% else %}
                <textarea class="form-control" name="observacoes" id="observacoes" rows="2" value=""></textarea>
                {% endif %}
                
                <button type='submit' name='editPedido' id='editPedido' class='btn btn-success'><i
                    class='fas fa-save'></i> editar</button>
                
            </div>
        </div>
    </div>
    {% if pagina == 'editar' %}
    <input type="hidden" name="id_pedido" value="{{pedido.id}}">

    <div class="row">
        <div class="col col-3">
            <div class="form-group">
                <label for="produto">Produto</label>
                <select name="id_produto" id="produto"  class="form-control">
                    <option value="">selecione</option>
                    {% for produto in tdProdutos %}
                    <option value="{{produto[0]}}">{{produto[1]}}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
         
        <div class="col col-3">
            <div class="form-group">
                <label for="valor">valor</label>
                <input name="valor" id="valor" type="text" readonly class="form-control">
            </div>
        </div>
        <div class="col col-3">
            <div class="form-group">
                <label for="quantidade">Quantidade</label>
                <input name="quantidade" id="quantidade" type="number" class="form-control" value="1">
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col col-3">
            <div class="form-group">
                <label for="total">Total R$</label>
                <input name="total" id="total" type="text" readonly class="form-control">
            </div>
        </div>
        <div class="col col-3">
            <div class="form-group">
                <label for="observacoes2">Observações</label>
                <input name="observacao" id="observacoes2" type="text" class="form-control">
            </div>
        </div>
    </div>


    <div class='form-row'>
        <div class='col'>
            <div class="form-group">
                <button type='submit' name='editProdutoDB' id='editProdutoDB' class='btn btn-success'><i
                    class='fas fa-save'></i> Salvar</button>

                 
            </div>
        </div>
    </div>

    {% endif %}

    {% if not produto and produto == 'None' %}
    <p>Pedido nao tem produto cadastrado.</p>
    {% else %}

    <table class="table table-sm table-hover table-responsive">
        <thead>
            <tr>
                <th>Imagem</th>
                <th scope="col">ID</th>
                <th scope="col">Quantidade</th>
                <th scope="col">valor</th>
                <th scope="col">Observações</th>
                <th scope="col">produto</th>
                <th scope="col">total</th>
            </tr>
        </thead>
        <tbody>
            
            {% for produto in produtos %}
            <tr>
                <td><img src="{{produto[7]|string}}"></td>
                <td>{{ produto[1] }}</td>
                <td>{{ produto[2] }}</td>
                <td>{{ produto[3] }}</td>
                <td>{{ produto[4] }}</td>
                <td>{{ produto[5] }}</td>
                {% set total = produto[2] * produto[3] %}
                <td>{{ total }}</td>
                <td>
                    <form action="{{ url_for('pedido.editProduto', id = pedido.id) }}" method="POST">
                            <button class='btn btn-primary' type='submit' name='formEditProduto'>alterar</button>
                    </form>
                    
                </td>
                {% endfor %}
            </tr>
        </tbody>
    </table>
   {% endif %}

    <!--<div class="row">
        <div class="col">
            <button class='btn btn-primary' type='submit'>Salvar Pedido</button>

        </div>
    </div>-->
    <form action="{{ url_for('pedido.formPedido') }}" method="POST">
            <button class="btn btn-info" type="submit" name="formNovoPedido"><i class="fas fa-plus-circle"></i>
                Novo Pedido</button>
    </form>





</form>
{% endblock %}